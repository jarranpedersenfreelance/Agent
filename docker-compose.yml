version: '3.8'
services:
  agent:
    build: .
    image: agent:latest
    container_name: agent_container
    working_dir: /app/workspace
    
    command: >
      /bin/sh -c "
      echo 'Workspace ready. Starting Agent.' &&
      PYTHONPATH=/app/workspace python3 core/agent_core.py
      "
      
    environment:
      - GEMINI_API_KEY=${GEMINI_API_KEY}
    volumes:
      - ./src:/app/src:ro
      - ./workspace:/app/workspace
      - ./tests:/app/tests:ro
      - ./README.md:/app/README.md:ro 
      - ./Dockerfile:/app/Dockerfile:ro
      - ./docker-compose.yml:/app/docker-compose.yml:ro
      - ./deploy:/app/deploy:ro
      - ./requirements.txt:/app/requirements.txt:ro
    restart: unless-stopped